# git 分支

使用分支意味着可以把工作从开发主线上分离开，避免影响开发主线。

在其他的版本控制系统中，可能需要完全创建一个源代码的副本，会很低效。Git与之不同，十分轻量

## 分支简介

**Git保存的不是文件的变化或差异，而是一系列不同时刻的快照**，Git使用blob对象保存快照

git在提交时，会保存一个commit object，其中包含

* 指向暂存内容快照的指针
* 作者姓名
* 邮箱
* commit message
* 指向父对象的指针

	首次提交产生的提交对象没有父对象，普通提交有一个父对象，多个分支合并时有多个父对象

### git提交流程

* 暂存操作计算每一个文件的校验和，将当前版本文件快照保存到git仓库，将校验和加入暂存区等待提交
* commit时计算每一个子目录的校验和，在Git仓库中将这些校验和保存为tree object
* 创建一个commit object，除正常内容外，还会包含指向tree object的指针

如此便可以在需要时快速重现快照

![commit-and-tree](https://git-scm.com/book/en/v2/images/commit-and-tree.png)

#### git分支本质上即为指向提交对象的可变指针，在每次提交时自动向前移动

### 分支创建

`git branch [new-branch-name]`：创建新分支，实质上为创建了一个可以移动的新指针，指向当前位置

![head-to-master](https://git-scm.com/book/en/v2/images/head-to-master.png)

Git中有一个名为`HEAD`的特殊指针，HEAD指针指向当前所在的本地分支，可以使用`git log`查看当前各个分支所指的对象

### 分支切换

`git checkout`：将HEAD指针切换到一个已存在的分支上，并且**工作区会变成该分支所指向的快照内容**

Git分支实质上仅包含所指对象校验和的文件（长度为40的SHA-1值字符串），故其创建和销毁都很高效。创建一个新分支就相当于向一个文件中写入41个字节（40个字符和1个换行符）