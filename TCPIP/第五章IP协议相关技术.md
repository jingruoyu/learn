## IP协议相关技术

实际通信中，仅依靠IP协议远远不够，还需要众多支持IP的相关技术才能实现最终通信

### 5.2 DNS

IP地址不便于记忆，平时不会直接使用IP地址，而是使用一个字符串，DNS将字符串转化为IP地址

`TCP/IP`刚开始为每个主机指定唯一的主机识别码，进行网络通信时直接使用主机名即可，系统会将主机名转换为具体的IP地址。主机名与IP地址的对应关系存储在hosts数据库文件中，网络中每接入一台主机就需要更新hosts文件

但是随着网络规模扩大，使用单一hosts文件可行性太低

#### 5.2.2 DNS的产生

DNS（Domain Name System）系统主机管理机构负责维护一个主机名与IP地址之间对应关系的**数据库**

用户输入主机名时，DNS会自动在数据库中检索定位其对应的IP地址。并且需要并更主机名与IP地址对应关系时，在组织机构内部进行处理即可，可以在一个较小的范围内对网络进行管理

#### 5.2.3 域名的构成

* 顶级域名：包括国别顶级域名、通用顶级域名等
* 分层域名：在顶级域名下，可以有多层域名

**域名服务器**：管理域名的主机和相应的软件，根部所设置的DNS叫做根域名服务器

每层域名服务器都注册着再往下一层域名服务器的IP地址，如果下面没有其他分层，就可以自由指定主机名称或子网名称

当需要修改域名服务器的名称或IP地址时，需要在其上层的域名服务器中进行追加或修改

域名和域名服务器需要分层设置，如果服务器宕机，则无法进行DNS查询，故为了提高容灾能力，一般会设置多个域名服务器

**所有域名服务器都必须注册根域名服务器的IP地址**，DNS进行IP检索时，是从根域名服务器开始的

**解析器**：进行DNS查询的主机和软件叫做解析器，其必须至少注册一个以上域名服务器的IP地址，才可以进行DNS查询

#### 5.2.4 DNS查询过程

1. 向DNS服务器查询域名的IP地址
2. 在接收查询请求的DNS服务器中，会先在自己的数据库中查找
	1. 如果查询到，直接返回
	2. 如果未查询到，则向上一层根域名服务器进行查询。根域名服务器返回其存储的主域名的DNS服务器IP地址。
	3. DNS服务器再向步骤2中拿到的DNS服务器请求域名的IP地址。
	4. 重复步骤2与步骤3，直至拿到域名的IP地址，返回给客户端
3. 客户端与对应域名开始通信

解析器和DNS服务器将最新了解到的信息暂时保存在缓存中，减少每次查询的性能消耗

**DNS系统如同互联网中的分布式数据库**，其中也存储了一些别的信息

### 5.3 ARP

在数据链路层通信需要了解每一个IP地址所对应的MAC地址

`ARP`是一种解决地址问题的协议，以目标IP地址为线索，用来定位下一个应该接收数据分包的网络设备对应的MAC地址。

`ARP`只适用于`IPv4`，`IPv6`下使用`ICMPv6`代替`ARP`发送邻居探索消息

#### 5.3.2 ARP工作机制